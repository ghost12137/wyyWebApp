{"remainingRequest":"F:\\Wamp_html\\examples\\vue\\16-wymusic\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Wamp_html\\examples\\vue\\16-wymusic\\src\\views\\songSquare\\SongSquare.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\Wamp_html\\examples\\vue\\16-wymusic\\src\\views\\songSquare\\SongSquare.vue","mtime":1617276580757},{"path":"F:\\Wamp_html\\examples\\vue\\16-wymusic\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Wamp_html\\examples\\vue\\16-wymusic\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\Wamp_html\\examples\\vue\\16-wymusic\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Wamp_html\\examples\\vue\\16-wymusic\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBnZXRTb25nVGl0bGVMaXN0LCBnZXRGaW5lV29ya0xpc3QsIGdldEhvdFdvcmtMaXN0IH0gZnJvbSAibmV0d29yay9zb25nc3F1YXJlIjsNCmltcG9ydCBTY3JvbGwgZnJvbSAnY29tcG9uZW50cy9jb21tb24vc2Nyb2xsL1Njcm9sbCc7DQoNCmltcG9ydCBUaXRsZVNjcm9sbCBmcm9tICcuL2NoaWxkQ29tcHMvVGl0bGVTY3JvbGwnOw0KaW1wb3J0IFNvbmdJdGVtIGZyb20gJy4vY2hpbGRDb21wcy9Tb25nSXRlbS52dWUnOw0KaW1wb3J0IHsgVG9hc3QgfSBmcm9tICd2YW50JzsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAnU29uZ1NxdWFyZScsDQogIGNvbXBvbmVudHM6IHsNCiAgICBUaXRsZVNjcm9sbCwNCiAgICBTY3JvbGwsDQogICAgU29uZ0l0ZW0sDQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHRpdGxlTGlzdDogW10sICAvL+agh+mimOWIl+ihqO+8jOaOqOiNkOetiQ0KICAgICAgY3VycmVudEluZGV4OiAwLC8v5b2T5YmN5pi+56S65YaF5a65DQogICAgICBTb25nTGlzdDogW10sICAgLy/mrYzljZXliJfooajvvIzmiYDku6UNCiAgICAgIGJlZm9yZTogJycsICAgICAgLy9iZWZvcmXlj4LmlbANCiAgICAgIHBhZ2U6IDAsDQogICAgfTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIC8qKg0KICAgICAqIOS6i+S7tuWTjeW6lOebuOWFs+aWueazlQ0KICAgICAqLw0KICAgIC8v54K55Ye75qCH6aKY5YiH5o2i5YaF5a65DQogICAgdGl0bGVDbGljayhpbmRleCkgew0KICAgICAgdGhpcy5jdXJyZW50SW5kZXggPSBpbmRleDsNCiAgICAgIC8v5riF56m65pWw5o2uDQogICAgICB0aGlzLlNvbmdMaXN0ID0gW107DQogICAgICB0aGlzLmJlZm9yZSA9ICcnOw0KICAgICAgdGhpcy5wYWdlID0gMDsNCiAgICAgIGlmIChpbmRleCA9PT0gMCkgew0KICAgICAgICB0aGlzLmdldEZpbmVXb3JrTGlzdCh0aGlzLnRpdGxlTGlzdFtpbmRleF0uaWQsIDMwKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuZ2V0SG90V29ya0xpc3QodGhpcy50aXRsZUxpc3RbaW5kZXhdLm5hbWUsIDMwLCB0aGlzLnBhZ2UpOw0KICAgICAgfQ0KICAgIH0sDQogICAgbG9hZE1vcmUoKSB7DQogICAgICBpZiAodGhpcy5jdXJyZW50SW5kZXggPT09IDApIHsNCiAgICAgICAgdGhpcy5nZXRGaW5lV29ya0xpc3QoMCwgMTUsIHRoaXMuYmVmb3JlKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuZ2V0SG90V29ya0xpc3QodGhpcy50aXRsZUxpc3RbdGhpcy5jdXJyZW50SW5kZXhdLm5hbWUsIDksIHRoaXMucGFnZSk7DQogICAgICB9DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDnvZHnu5zor7fmsYLnm7jlhbPmlrnms5UNCiAgICAgKi8NCiAgICAvL+iOt+WPluatjOWNleagh+mimA0KICAgIGdldFNvbmdUaXRsZUxpc3QoKSB7DQogICAgICBnZXRTb25nVGl0bGVMaXN0KCkNCiAgICAgICAgLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICBjb25zb2xlLmxvZygicmVzIG9mIHNvbmcgdGl0bGUgaW4gc29uZ3NxdWFyZTogIiwgcmVzKTsNCiAgICAgICAgICB0aGlzLnRpdGxlTGlzdCA9IHJlcy50YWdzLnNsaWNlKDAsIDUpOw0KICAgICAgICAgIGxldCByZWNvbW1lbmQgPSB7DQogICAgICAgICAgICBuYW1lOiAn57K+5ZOBJywNCiAgICAgICAgICAgIGlkOiAwDQogICAgICAgICAgfTsNCiAgICAgICAgICB0aGlzLnRpdGxlTGlzdC51bnNoaWZ0KHJlY29tbWVuZCk7DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaChlcnIgPT4gew0KICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnJvciBvZiBzb25nIHRpdGxlIGluIHNvbmdzcXVhcmU6JywgZXJyKTsNCiAgICAgICAgfSkNCiAgICB9LA0KICAgIC8v6I635Y+W57K+5ZOB5q2M5Y2VDQogICAgZ2V0RmluZVdvcmtMaXN0KHR5cGUsIGxpbWl0LCBiZWZvcmUpIHsNCiAgICAgIFRvYXN0LmxvYWRpbmcoew0KICAgICAgICBkdXJhdGlvbjogMCwNCiAgICAgICAgZm9yYmlkQ2xpY2s6IHRydWUsDQogICAgICAgIG1lc3NhZ2U6ICfliqDovb3kuK0nDQogICAgICB9KTsNCiAgICAgIGdldEZpbmVXb3JrTGlzdCh0eXBlLCBsaW1pdCwgYmVmb3JlKQ0KICAgICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgb2YgZmluZSB3b3JrIGluIHRpdGxlc2Nyb2xsOiAnLCByZXMpOw0KICAgICAgICAgIHRoaXMuU29uZ0xpc3QucHVzaCguLi5yZXMucGxheWxpc3RzKTsNCiAgICAgICAgICB0aGlzLmJlZm9yZSA9IHJlcy5sYXN0dGltZTsNCiAgICAgICAgICBpZiAodHlwZW9mIChiZWZvcmUpICE9ICd1bmRlZmluZWQnKSB7DQogICAgICAgICAgICB0aGlzLiRyZWZzLnNvbmdTY3JvbGwuZmluaXNoUHVsbFVwKCk7DQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goZXJyID0+IHsNCiAgICAgICAgICBjb25zb2xlLmxvZygnZXJyb3Igb2YgZmluZSB3b3JrIGluIHRpdGxlc2Nyb2xsOiAnLCBlcnIpOw0KICAgICAgICB9KQ0KICAgICAgICAuZmluYWxseSgoKSA9PiB7DQogICAgICAgICAgVG9hc3QuY2xlYXIoKTsNCiAgICAgICAgfSkNCiAgICB9LA0KICAgIC8vIOiOt+WPlueDremXqOatjOWNlQ0KICAgIGdldEhvdFdvcmtMaXN0KGNhdCwgbGltaXQsIG9mZnNldCkgew0KICAgICAgVG9hc3QubG9hZGluZyh7DQogICAgICAgIGR1cmF0aW9uOiAwLA0KICAgICAgICBmb3JiaWRDbGljazogdHJ1ZSwNCiAgICAgICAgbWVzc2FnZTogJ+WKoOi9veS4rScNCiAgICAgIH0pOw0KICAgICAgZ2V0SG90V29ya0xpc3QoY2F0LCBsaW1pdCwgb2Zmc2V0KQ0KICAgICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgb2YgaG90IHdvcmsgbGlzdCBpbiBzb25nc3F1YXJlOicsIHJlcyk7DQogICAgICAgICAgdGhpcy5Tb25nTGlzdC5wdXNoKC4uLnJlcy5wbGF5bGlzdHMpOw0KICAgICAgICAgIGlmICh0aGlzLnBhZ2UgPT0gMCkgew0KICAgICAgICAgICAgdGhpcy5wYWdlID0gMzA7DQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMucGFnZSArPSA5Ow0KICAgICAgICAgIH0NCiAgICAgICAgICBpZiAodGhpcy5wYWdlKSB7DQogICAgICAgICAgICB0aGlzLiRyZWZzLnNvbmdTY3JvbGwuZmluaXNoUHVsbFVwKCk7DQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goZXJyID0+IHsNCiAgICAgICAgICBjb25zb2xlLmxvZygnZXJyb3Igb2YgaG90IHdvcmsgbGlzdCBpbiBzb25nc3F1YXJlOicsIGVycik7DQogICAgICAgIH0pDQogICAgICAgIC5maW5hbGx5KCgpID0+IHsNCiAgICAgICAgICBUb2FzdC5jbGVhcigpOw0KICAgICAgICB9KTsNCiAgICB9LA0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIC8v6I635Y+W5q2M5Y2V5qCH6aKYDQogICAgdGhpcy5nZXRTb25nVGl0bGVMaXN0KCk7DQogICAgLy/ojrflj5bnsr7lk4HmrYzljZUNCiAgICB0aGlzLmdldEZpbmVXb3JrTGlzdCgwLCAzMCk7DQogIH0sDQp9DQo="},{"version":3,"sources":["SongSquare.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAmBA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SongSquare.vue","sourceRoot":"src/views/songSquare","sourcesContent":["<template>\r\n  <div class=\"song-square\">\r\n    <!-- 标题滚条 -->\r\n    <title-scroll :title-list=\"titleList\" @titleClick=\"titleClick\" />\r\n\r\n    <scroll\r\n      class=\"song-scroll\"\r\n      :pull-up-load=\"true\"\r\n      ref=\"songScroll\"\r\n      @pullingUp=\"loadMore\"\r\n    >\r\n      <div class=\"song-content\">\r\n        <song-item v-for=\"item in SongList\" :key=\"item.id\" :item=\"item\" />\r\n      </div>\r\n    </scroll>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getSongTitleList, getFineWorkList, getHotWorkList } from \"network/songsquare\";\r\nimport Scroll from 'components/common/scroll/Scroll';\r\n\r\nimport TitleScroll from './childComps/TitleScroll';\r\nimport SongItem from './childComps/SongItem.vue';\r\nimport { Toast } from 'vant';\r\n\r\nexport default {\r\n  name: 'SongSquare',\r\n  components: {\r\n    TitleScroll,\r\n    Scroll,\r\n    SongItem,\r\n  },\r\n  data() {\r\n    return {\r\n      titleList: [],  //标题列表，推荐等\r\n      currentIndex: 0,//当前显示内容\r\n      SongList: [],   //歌单列表，所以\r\n      before: '',      //before参数\r\n      page: 0,\r\n    };\r\n  },\r\n  methods: {\r\n    /**\r\n     * 事件响应相关方法\r\n     */\r\n    //点击标题切换内容\r\n    titleClick(index) {\r\n      this.currentIndex = index;\r\n      //清空数据\r\n      this.SongList = [];\r\n      this.before = '';\r\n      this.page = 0;\r\n      if (index === 0) {\r\n        this.getFineWorkList(this.titleList[index].id, 30);\r\n      } else {\r\n        this.getHotWorkList(this.titleList[index].name, 30, this.page);\r\n      }\r\n    },\r\n    loadMore() {\r\n      if (this.currentIndex === 0) {\r\n        this.getFineWorkList(0, 15, this.before);\r\n      } else {\r\n        this.getHotWorkList(this.titleList[this.currentIndex].name, 9, this.page);\r\n      }\r\n    },\r\n    /**\r\n     * 网络请求相关方法\r\n     */\r\n    //获取歌单标题\r\n    getSongTitleList() {\r\n      getSongTitleList()\r\n        .then(res => {\r\n          console.log(\"res of song title in songsquare: \", res);\r\n          this.titleList = res.tags.slice(0, 5);\r\n          let recommend = {\r\n            name: '精品',\r\n            id: 0\r\n          };\r\n          this.titleList.unshift(recommend);\r\n        })\r\n        .catch(err => {\r\n          console.log('error of song title in songsquare:', err);\r\n        })\r\n    },\r\n    //获取精品歌单\r\n    getFineWorkList(type, limit, before) {\r\n      Toast.loading({\r\n        duration: 0,\r\n        forbidClick: true,\r\n        message: '加载中'\r\n      });\r\n      getFineWorkList(type, limit, before)\r\n        .then(res => {\r\n          console.log('res of fine work in titlescroll: ', res);\r\n          this.SongList.push(...res.playlists);\r\n          this.before = res.lasttime;\r\n          if (typeof (before) != 'undefined') {\r\n            this.$refs.songScroll.finishPullUp();\r\n          }\r\n        })\r\n        .catch(err => {\r\n          console.log('error of fine work in titlescroll: ', err);\r\n        })\r\n        .finally(() => {\r\n          Toast.clear();\r\n        })\r\n    },\r\n    // 获取热门歌单\r\n    getHotWorkList(cat, limit, offset) {\r\n      Toast.loading({\r\n        duration: 0,\r\n        forbidClick: true,\r\n        message: '加载中'\r\n      });\r\n      getHotWorkList(cat, limit, offset)\r\n        .then(res => {\r\n          console.log('res of hot work list in songsquare:', res);\r\n          this.SongList.push(...res.playlists);\r\n          if (this.page == 0) {\r\n            this.page = 30;\r\n          } else {\r\n            this.page += 9;\r\n          }\r\n          if (this.page) {\r\n            this.$refs.songScroll.finishPullUp();\r\n          }\r\n        })\r\n        .catch(err => {\r\n          console.log('error of hot work list in songsquare:', err);\r\n        })\r\n        .finally(() => {\r\n          Toast.clear();\r\n        });\r\n    },\r\n  },\r\n  created() {\r\n    //获取歌单标题\r\n    this.getSongTitleList();\r\n    //获取精品歌单\r\n    this.getFineWorkList(0, 30);\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.song-square {\r\n  background-color: #f6f6f4;\r\n  height: calc(100vh - 50px);\r\n  overflow: hidden;\r\n}\r\n.song-scroll {\r\n  margin-top: 40px;\r\n  height: calc(100% - 50px);\r\n  overflow: hidden;\r\n}\r\n.song-content {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: space-around;\r\n  height: calc(100% - 50px);\r\n}\r\n</style>"]}]}