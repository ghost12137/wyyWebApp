{"remainingRequest":"F:\\Wamp_html\\examples\\vue\\16-wymusic\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Wamp_html\\examples\\vue\\16-wymusic\\src\\views\\songSquare\\SongSquare.vue?vue&type=style&index=0&id=03202db6&scoped=true&lang=css&","dependencies":[{"path":"F:\\Wamp_html\\examples\\vue\\16-wymusic\\src\\views\\songSquare\\SongSquare.vue","mtime":1617362373763},{"path":"F:\\Wamp_html\\examples\\vue\\16-wymusic\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Wamp_html\\examples\\vue\\16-wymusic\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"F:\\Wamp_html\\examples\\vue\\16-wymusic\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"F:\\Wamp_html\\examples\\vue\\16-wymusic\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Wamp_html\\examples\\vue\\16-wymusic\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5zb25nLXNxdWFyZSB7DQogIGJhY2tncm91bmQtY29sb3I6ICNmNmY2ZjQ7DQogIGhlaWdodDogY2FsYygxMDB2aCAtIDUwcHgpOw0KICBvdmVyZmxvdzogaGlkZGVuOw0KfQ0KLnNvbmctc2Nyb2xsIHsNCiAgbWFyZ2luLXRvcDogNDBweDsNCiAgaGVpZ2h0OiBjYWxjKDEwMCUgLSA1MHB4KTsNCiAgb3ZlcmZsb3c6IGhpZGRlbjsNCn0NCi5zb25nLWNvbnRlbnQgew0KICBkaXNwbGF5OiBmbGV4Ow0KICBmbGV4LXdyYXA6IHdyYXA7DQogIGp1c3RpZnktY29udGVudDogc3BhY2UtYXJvdW5kOw0KICBoZWlnaHQ6IGNhbGMoMTAwJSAtIDUwcHgpOw0KfQ0K"},{"version":3,"sources":["SongSquare.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SongSquare.vue","sourceRoot":"src/views/songSquare","sourcesContent":["<template>\r\n  <div class=\"song-square\">\r\n    <!-- 标题滚条 -->\r\n    <title-scroll :title-list=\"titleList\" @titleClick=\"titleClick\" />\r\n\r\n    <scroll\r\n      class=\"song-scroll\"\r\n      :pull-up-load=\"true\"\r\n      ref=\"songScroll\"\r\n      @pullingUp=\"loadMore\"\r\n    >\r\n      <div class=\"song-content\">\r\n        <song-item\r\n          v-for=\"item in SongList\" \r\n          :key=\"item.id\" \r\n          :item=\"item\" />\r\n      </div>\r\n    </scroll>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getSongTitleList, getFineWorkList, getHotWorkList } from \"network/songsquare\";\r\nimport Scroll from 'components/common/scroll/Scroll';\r\n\r\nimport TitleScroll from './childComps/TitleScroll';\r\nimport SongItem from './childComps/SongItem.vue';\r\nimport { Toast } from 'vant';\r\n\r\nexport default {\r\n  name: 'SongSquare',\r\n  components: {\r\n    TitleScroll,\r\n    Scroll,\r\n    SongItem,\r\n  },\r\n  data() {\r\n    return {\r\n      titleList: [],  //标题列表，推荐等\r\n      currentIndex: 0,//当前显示内容\r\n      SongList: [],   //歌单列表，所以\r\n      before: '',      //before参数\r\n      page: 0,\r\n    };\r\n  },\r\n  methods: {\r\n    /**\r\n     * 事件响应相关方法\r\n     */\r\n    //点击标题切换内容\r\n    titleClick(index) {\r\n      this.currentIndex = index;\r\n      //清空数据\r\n      this.SongList = [];\r\n      this.before = '';\r\n      this.page = 0;\r\n      if (index === 0) {\r\n        this.getFineWorkList(this.titleList[index].id, 30);\r\n      } else {\r\n        this.getHotWorkList(this.titleList[index].name, 30, this.page);\r\n      }\r\n    },\r\n    //上拉加载更多\r\n    loadMore() {\r\n      if (this.currentIndex === 0) {\r\n        this.getFineWorkList(0, 15, this.before);\r\n      } else {\r\n        this.getHotWorkList(this.titleList[this.currentIndex].name, 9, this.page);\r\n      }\r\n    },\r\n    /**\r\n     * 网络请求相关方法\r\n     */\r\n    //获取歌单标题\r\n    getSongTitleList() {\r\n      getSongTitleList()\r\n        .then(res => {\r\n          console.log(\"res of song title in songsquare: \", res);\r\n          this.titleList = res.tags.slice(0, 5);\r\n          let recommend = {\r\n            name: '精品',\r\n            id: 0\r\n          };\r\n          this.titleList.unshift(recommend);\r\n        })\r\n        .catch(err => {\r\n          console.log('error of song title in songsquare:', err);\r\n        })\r\n    },\r\n    //获取精品歌单\r\n    getFineWorkList(type, limit, before) {\r\n      Toast.loading({\r\n        duration: 0,\r\n        forbidClick: true,\r\n        message: '加载中'\r\n      });\r\n      getFineWorkList(type, limit, before)\r\n        .then(res => {\r\n          // console.log('res of fine work in titlescroll: ', res);\r\n          this.SongList.push(...res.playlists);\r\n          this.before = res.lasttime;\r\n          if (typeof (before) != 'undefined') {\r\n            this.$refs.songScroll.finishPullUp();\r\n          }\r\n        })\r\n        .catch(err => {\r\n          console.log('error of fine work in titlescroll: ', err);\r\n        })\r\n        .finally(() => {\r\n          Toast.clear();\r\n        })\r\n    },\r\n    // 获取热门歌单\r\n    getHotWorkList(cat, limit, offset) {\r\n      Toast.loading({\r\n        duration: 0,\r\n        forbidClick: true,\r\n        message: '加载中'\r\n      });\r\n      getHotWorkList(cat, limit, offset)\r\n        .then(res => {\r\n          // console.log('res of hot work list in songsquare:', res);\r\n          this.SongList.push(...res.playlists);\r\n          if (this.page == 0) {\r\n            this.page = 30;\r\n          } else {\r\n            this.page += 9;\r\n          }\r\n          if (this.page) {\r\n            this.$refs.songScroll.finishPullUp();\r\n          }\r\n        })\r\n        .catch(err => {\r\n          console.log('error of hot work list in songsquare:', err);\r\n        })\r\n        .finally(() => {\r\n          Toast.clear();\r\n        });\r\n    },\r\n  },\r\n  created() {\r\n    //获取歌单标题\r\n    this.getSongTitleList();\r\n    //获取精品歌单\r\n    this.getFineWorkList(0, 30);\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.song-square {\r\n  background-color: #f6f6f4;\r\n  height: calc(100vh - 50px);\r\n  overflow: hidden;\r\n}\r\n.song-scroll {\r\n  margin-top: 40px;\r\n  height: calc(100% - 50px);\r\n  overflow: hidden;\r\n}\r\n.song-content {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: space-around;\r\n  height: calc(100% - 50px);\r\n}\r\n</style>"]}]}